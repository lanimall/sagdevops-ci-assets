<?xml version="1.0"?>
<project name="ProjectInitializer" default="" basedir="." >

    <target name="globalInit" depends="initSAGHome">
        <condition property="sag.ci.home" value="${env.SAG_CI_HOME}" >
            <isset property="env.SAG_CI_HOME" />
        </condition>
        <property name="sag.ci.home" value="." />

        <property file="${sag.ci.home}/System.properties"/>


        <path description="" id="cc.ant.classpath">
            <fileset dir="${sag.ci.home}" includes="lib/*.jar" />
        </path>

        <taskdef classpathref="cc.ant.classpath" resource="net/sf/antcontrib/antlib.xml"/>
    </target>

    <!-- system properties properties -->
	<target name="initSAGHome" unless="SAGHome">
        <condition property="SAGHome" value="${env.SAGHome}" >
            <isset property="env.SAGHome" />
        </condition>
        <property name="SAGHome" value="/opt/softwareag" />

        <echo>${SAGHome}</echo>
        <fail message="System property 'SAGHome' should be defined!" unless="SAGHome"/>
	</target>

	<target name="initDeployerInstallationPath" unless="deployerInstallationPath">
		<fail message="System property 'deployerInstallationPath' should be defined!"/>
	</target>

	<target name="initDeployerHost" unless="deployerHost">
		<fail message="System property 'deployerHost' should be defined!"/>
	</target>
	
	<target name="initDeployerPort" unless="deployerPort">
		<fail message="System property 'deployerPort' should be defined!"/>
	</target>
	
	<target name="initDeployerUsername" unless="deployerUsername">
		<fail message="System property 'deployerUsername' should be defined!"/>
	</target>
	
	<target name="initDeployerPassword" unless="deployerPassword">
		<fail message="System property 'deployerPassword' should be defined!"/>
	</target>
			
	<!-- mandatory properties -->
	<target name="initProjcetName" unless="projectName">
        <condition property="projectName" value="${env.JOB_NAME}" >
            <isset property="env.JOB_NAME" />
        </condition>

        <fail message="Property 'projectName' should be defined!"/>
	</target>
		
	<target name="initBuildOutputDir" unless="buildOutputDir">
		<fail message="Property 'buildOutputDir' should be defined!"/>
	</target>
	
	<target name="initRepositoryName" unless="repositoryName">
		<fail message="Property 'repositoryName' should be defined!"/>
	</target>
	
	<target name="initDeployerProjectDefinition" unless="deployerProjectDefinition" depends="initProjcetName">
        <!-- Target filename of the Deployer Project Specification for this run -->
        <property name="deployerProjectDefinition" value="${workspace.dir}/target/ProjectAutomator/${projectName}DeploymentSpec.xml"/>

        <fail message="Property 'deployerProjectDefinition' should be defined!" unless="deployerProjectDefinition"/>
	</target>

	<!-- optional build properties -->
	<target name="initISProjectsDir" unless="isProjectsDir">
		<property name="isProjectsDir" value=""/>
	</target>
	
	<target name="initISConfigDir" unless="isConfigDir">
		<property name="isConfigDir" value=""/>
	</target>

    <target name="initISTestsDir" unless="isTestDir">
        <property name="isTestDir" value=""/>
    </target>
	
	<target name="initBPMProjectsDir" unless="bpmProjectsDir">
		<property name="bpmProjectsDir" value=""/>
	</target>
	
	<target name="initMWSProjectsDir" unless="mwsProjectsDir">
		<property name="mwsProjectsDir" value=""/>
	</target>
	
	<target name="initRulesProjectsDir" unless="rulesProjectsDir">
		<property name="rulesProjectsDir" value=""/>
	</target>
	
	<target name="initUMProjectDir" unless="umProjectsDir">
		<property name="umProjectsDir" value=""/>
	</target>
	
	<target name="initTestPackageNamePattern" unless="testPackageNamePattern">
		<property name="testPackageNamePattern" value=""/>
	</target>

	<target name="initJenkinsReportDir" unless="jenkinsReportDir">
		<property name="jenkinsReportDir" value=""/>
	</target>

	<!--Main Init targets-->
    <target name="baseInitABEBuild" depends="globalInit,initSAGHome,initABEProperties" description="init properties needed for the ABE build phase">
        <echo>Done initABEBuild!!</echo>
    </target>

    <target name="baseInitDeployer" depends="globalInit,initSAGHome,initDeployerSystemProperties,initDeployerMandatoryProperties" description="init properties needed for the Deployer phase">
        <echo>Done initDeployer!!</echo>
    </target>

    <target name="baseInitTests" depends="globalInit,initSAGHome, initISTestsDir, initTestPackageNamePattern,initJenkinsReportDir" description="init properties needed for the Test phase">
        <echo>Done initTests!!</echo>
    </target>

    <target name="initABEProperties" depends="initBuildOutputDir,initISProjectsDir,initISConfigDir,initBPMProjectsDir,initMWSProjectsDir,initRulesProjectsDir,initUMProjectDir">
    </target>

    <target name="initDeployerSystemProperties" depends="initDeployerInstallationPath,initDeployerHost,initDeployerPort,initDeployerUsername,initDeployerPassword">
    </target>

	<target name="initDeployerMandatoryProperties" depends="initProjcetName,initRepositoryName,initDeployerProjectDefinition">
	</target>
</project>
